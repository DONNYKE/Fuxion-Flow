{"ast":null,"code":"import React,{useState,useEffect}from'react';import{motion,AnimatePresence}from'framer-motion';import{Plus,CheckCircle,XCircle,Truck,History,Phone,MessageSquare,DollarSign,Star}from'lucide-react';import{supabase}from'../supabaseClient';import LoadingSpinner from'../components/LoadingSpinner';import{parseISO,isBefore,subDays,isValid}from'date-fns';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Home=()=>{const[loading,setLoading]=useState(true);const[orders,setOrders]=useState([]);const[products,setProducts]=useState([]);const[customers,setCustomers]=useState([]);const[showNewOrderModal,setShowNewOrderModal]=useState(false);// Formulario de nuevo pedido\nconst[selectedCustomer,setSelectedCustomer]=useState('');const[selectedProducts,setSelectedProducts]=useState([{productId:'',quantity:1}]);const[deliveryDate,setDeliveryDate]=useState('');const[isPaidNewOrder,setIsPaidNewOrder]=useState(true);// Nuevo estado para el checkbox de pago\nuseEffect(()=>{fetchData();},[]);const fetchData=async()=>{setLoading(true);const{data:{user}}=await supabase.auth.getUser();// Obtener el usuario actual\nif(!user){setLoading(false);// Si no hay usuario, no se pueden cargar datos específicos del usuario\n// Puedes mostrar un mensaje o redirigir si es necesario\nreturn;}const{data:productsData,error:productsError}=await supabase.from('products').select('*').eq('user_id',user.id);// Filtrar por user_id\nif(productsError)console.error('Error fetching products:',productsError.message);setProducts(productsData||[]);const{data:ordersData,error:ordersError}=await supabase.from('orders').select('*, order_items(*), customers(id, name, phone_number)').eq('user_id',user.id)// Filtrar por user_id\n.order('delivery_date',{ascending:true});if(ordersError)console.error('Error fetching orders:',ordersError.message);setOrders(ordersData||[]);const{data:customersData,error:customersError}=await supabase.from('customers').select('*').eq('user_id',user.id);// Filtrar por user_id\nif(customersError)console.error('Error fetching customers:',customersError.message);setCustomers(customersData||[]);setLoading(false);};const calculateOrderTotals=orderItems=>{let totalPoints=0;let totalPrice=0;orderItems.forEach(item=>{const product=products.find(p=>p.id===(item.productId||item.product_id));if(product){totalPoints+=product.points_per_unit*item.quantity;totalPrice+=product.price_per_unit*item.quantity;}});return{totalPoints,totalPrice};};const handleUpdateOrderStatus=async(orderId,status)=>{setLoading(true);const completedAt=status==='delivered'?new Date().toISOString():null;const{data:{user}}=await supabase.auth.getUser();// Si se marca como entregado, por defecto se marca como pagado\nconst updateData={status:status,completed_at:completedAt};if(status==='delivered'){updateData.is_paid=true;// Por defecto, pagado al entregar\n}const{error:orderUpdateError}=await supabase.from('orders').update(updateData).eq('id',orderId).eq('user_id',user.id);// Asegurar que solo se actualiza la propia orden\nif(orderUpdateError){console.error('Error updating order status:',orderUpdateError.message);setLoading(false);return;}if(status==='delivered'){const orderToUpdate=orders.find(o=>o.id===orderId);if(orderToUpdate&&orderToUpdate.order_items){for(const item of orderToUpdate.order_items){const{data:currentProductData,error:fetchProductError}=await supabase.from('products').select('quantity').eq('id',item.product_id).eq('user_id',user.id)// Asegurar que solo se actualiza el propio producto\n.single();if(fetchProductError){console.error('Error fetching current product quantity:',fetchProductError.message);continue;}if(currentProductData){const newQuantity=currentProductData.quantity-item.quantity;const{error:productUpdateError}=await supabase.from('products').update({quantity:newQuantity}).eq('id',item.product_id).eq('user_id',user.id);// Asegurar que solo se actualiza el propio producto\nif(productUpdateError)console.error('Error updating product quantity:',productUpdateError.message);}}}}await fetchData();setLoading(false);};const handleTogglePaidStatus=async(orderId,currentPaidStatus)=>{setLoading(true);const{data:{user}}=await supabase.auth.getUser();const{error}=await supabase.from('orders').update({is_paid:!currentPaidStatus}).eq('id',orderId).eq('user_id',user.id);if(error){console.error('Error updating paid status:',error.message);}await fetchData();setLoading(false);};const handleAddProductToOrder=()=>{setSelectedProducts([...selectedProducts,{productId:'',quantity:1}]);};const handleProductChange=(index,field,value)=>{const newSelectedProducts=[...selectedProducts];newSelectedProducts[index][field]=value;setSelectedProducts(newSelectedProducts);};const handleRemoveProductFromOrder=index=>{const newSelectedProducts=selectedProducts.filter((_,i)=>i!==index);setSelectedProducts(newSelectedProducts);};const handleCreateOrder=async e=>{e.preventDefault();setLoading(true);const{data:{user}}=await supabase.auth.getUser();if(!user){alert('Debes iniciar sesión para crear un pedido.');setLoading(false);return;}const userId=user.id;const{totalPoints,totalPrice}=calculateOrderTotals(selectedProducts);const{data:newOrder,error:orderError}=await supabase.from('orders').insert({customer_id:selectedCustomer,delivery_date:deliveryDate,total_points:totalPoints,total_price:totalPrice,status:'pending',is_paid:isPaidNewOrder,// Usar el estado del checkbox\nuser_id:userId// Asignar el user_id\n}).select().single();if(orderError){console.error('Error creating order:',orderError.message);setLoading(false);return;}const orderItemsToInsert=selectedProducts.map(item=>{const product=products.find(p=>p.id===item.productId);return{order_id:newOrder.id,product_id:item.productId,quantity:item.quantity,points_at_sale:product?product.points_per_unit:0,price_at_sale:product?product.price_per_unit:0};});const{error:orderItemsError}=await supabase.from('order_items').insert(orderItemsToInsert);if(orderItemsError){console.error('Error creating order items:',orderItemsError.message);await supabase.from('orders').delete().eq('id',newOrder.id);}else{setShowNewOrderModal(false);setSelectedCustomer('');setSelectedProducts([{productId:'',quantity:1}]);setDeliveryDate('');setIsPaidNewOrder(true);// Resetear a pagado por defecto\nawait fetchData();}setLoading(false);};const getWhatsAppLink=(phoneNumber,message)=>{const formattedPhone=phoneNumber.replace(/\\D/g,'');return`https://wa.me/${formattedPhone}?text=${encodeURIComponent(message)}`;};const pendingOrders=orders.filter(order=>order.status==='pending');const deliveredOrdersLast60Days=orders.filter(order=>{if(order.status!=='delivered'||!order.completed_at){return false;}const completedDate=parseISO(order.completed_at);const sixtyDaysAgo=subDays(new Date(),60);return isValid(completedDate)&&isBefore(sixtyDaysAgo,completedDate);});// Calcular totales para pedidos pendientes\nconst totalPendingPoints=pendingOrders.reduce((sum,order)=>sum+(order.total_points||0),0);const totalPendingPrice=pendingOrders.reduce((sum,order)=>sum+(order.total_price||0),0);// Calcular totales para pedidos entregados en los últimos 60 días\nconst totalDelivered60DaysPoints=deliveredOrdersLast60Days.reduce((sum,order)=>sum+(order.total_points||0),0);const totalDelivered60DaysPrice=deliveredOrdersLast60Days.reduce((sum,order)=>sum+(order.total_price||0),0);if(loading){return/*#__PURE__*/_jsx(LoadingSpinner,{});}return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 pb-4\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"container mx-auto px-2 py-4 max-w-4xl\",children:[\" \",/*#__PURE__*/_jsx(motion.h1,{className:\"text-3xl font-extrabold text-gray-900 mb-4 text-center bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600\"// Reducido text-4xl a text-3xl, mb-6 a mb-4\n,initial:{opacity:0,y:-50},animate:{opacity:1,y:0},transition:{duration:0.6},children:\"FuxionFlow\"}),/*#__PURE__*/_jsxs(motion.div,{className:\"bg-white/90 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-4 mb-4 shadow-md\"// Reducido padding, mb, shadow, rounded\n,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.5,delay:0.2},children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-2 flex items-center gap-1.5\",children:[\" \",/*#__PURE__*/_jsx(Plus,{className:\"w-5 h-5 text-blue-500\"}),\" Nuevo Pedido\"]}),/*#__PURE__*/_jsxs(motion.button,{onClick:()=>setShowNewOrderModal(true),className:\"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-2 rounded-lg font-semibold shadow-sm hover:shadow-md hover:scale-105 transition-all duration-300 flex items-center justify-center gap-1.5\"// Reducido py, rounded, shadow\n,whileHover:{scale:1.02},whileTap:{scale:0.98},children:[/*#__PURE__*/_jsx(Plus,{className:\"w-4 h-4\"}),\" \",\"Crear Nuevo Pedido\"]})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:showNewOrderModal&&/*#__PURE__*/_jsx(motion.div,{className:\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 z-50\"// Reducido padding\n,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:/*#__PURE__*/_jsxs(motion.div,{className:\"bg-white rounded-2xl p-5 shadow-xl max-w-md w-full max-h-[95vh] overflow-y-auto\"// Reducido padding, rounded, max-h\n,initial:{scale:0.9,y:50},animate:{scale:1,y:0},exit:{scale:0.9,y:50},transition:{type:'spring',stiffness:100,damping:15},children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-xl font-bold text-gray-800 mb-4\",children:\"Detalles del Nuevo Pedido\"}),\" \",/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCreateOrder,className:\"space-y-3\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"customer\",className:\"block text-gray-700 font-medium mb-1\",children:\"Cliente:\"}),\" \",/*#__PURE__*/_jsxs(\"select\",{id:\"customer\",value:selectedCustomer,onChange:e=>setSelectedCustomer(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30\"// Reducido py, rounded\n,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona un cliente\"}),customers.map(customer=>/*#__PURE__*/_jsx(\"option\",{value:customer.id,children:customer.name},customer.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[\" \",/*#__PURE__*/_jsx(\"label\",{className:\"block text-gray-700 font-medium mb-1\",children:\"Productos:\"}),\" \",selectedProducts.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-end gap-2 bg-gray-50 p-2 rounded-lg border border-gray-200\",children:[\" \",/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:`product-${index}`,className:\"block text-gray-600 text-xs mb-0.5\",children:\"Producto:\"}),\" \",/*#__PURE__*/_jsxs(\"select\",{id:`product-${index}`,value:item.productId,onChange:e=>handleProductChange(index,'productId',e.target.value),className:\"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500/30\"// Reducido py, rounded\n,required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"\",children:\"Selecciona un producto\"}),products.map(product=>/*#__PURE__*/_jsx(\"option\",{value:product.id,children:product.name},product.id))]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:`quantity-${index}`,className:\"block text-gray-600 text-xs mb-0.5\",children:\"Cant:\"}),\" \",/*#__PURE__*/_jsx(\"input\",{id:`quantity-${index}`,type:\"number\",value:item.quantity,onChange:e=>handleProductChange(index,'quantity',parseInt(e.target.value)||1),min:\"1\",className:\"w-14 px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500/30\"// Reducido w, py, rounded\n,required:true})]}),/*#__PURE__*/_jsxs(motion.button,{type:\"button\",onClick:()=>handleRemoveProductFromOrder(index),className:\"p-1 bg-red-100 text-red-600 rounded-md hover:bg-red-200 transition-colors\"// Reducido padding, rounded\n,whileHover:{scale:1.1},whileTap:{scale:0.9},children:[/*#__PURE__*/_jsx(XCircle,{className:\"w-3 h-3\"}),\" \"]})]},index)),/*#__PURE__*/_jsxs(motion.button,{type:\"button\",onClick:handleAddProductToOrder,className:\"w-full bg-blue-100 text-blue-600 py-1.5 rounded-lg font-semibold text-sm hover:bg-blue-200 transition-colors flex items-center justify-center gap-1.5\"// Reducido py, rounded, text-sm\n,whileHover:{scale:1.02},whileTap:{scale:0.98},children:[/*#__PURE__*/_jsx(Plus,{className:\"w-3 h-3\"}),\" \",\"Agregar Otro Producto\"]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"deliveryDate\",className:\"block text-gray-700 font-medium mb-1\",children:\"Fecha de Entrega:\"}),\" \",/*#__PURE__*/_jsx(\"input\",{id:\"deliveryDate\",type:\"date\",value:deliveryDate,onChange:e=>setDeliveryDate(e.target.value),className:\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30\"// Reducido py, rounded\n,required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2\",children:[/*#__PURE__*/_jsx(\"input\",{id:\"isPaidNewOrder\",type:\"checkbox\",checked:isPaidNewOrder,onChange:e=>setIsPaidNewOrder(e.target.checked),className:\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:\"isPaidNewOrder\",className:\"text-gray-700 font-medium text-sm\",children:\"Pedido Pagado\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end gap-2 mt-4\",children:[\" \",/*#__PURE__*/_jsx(motion.button,{type:\"button\",onClick:()=>setShowNewOrderModal(false),className:\"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg font-semibold text-sm hover:bg-gray-300 transition-colors\"// Reducido px, py, rounded, text-sm\n,whileHover:{scale:1.05},whileTap:{scale:0.95},children:\"Cancelar\"}),/*#__PURE__*/_jsx(motion.button,{type:\"submit\",className:\"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold text-sm shadow-sm hover:shadow-md hover:scale-105 transition-all duration-300\"// Reducido px, py, rounded, text-sm, shadow\n,whileHover:{scale:1.05},whileTap:{scale:0.95},children:\"Guardar Pedido\"})]})]})]})})}),/*#__PURE__*/_jsxs(motion.div,{className:\"bg-white/90 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-4 mb-4 shadow-md\"// Reducido padding, mb, shadow, rounded\n,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.5,delay:0.3},children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-2 flex items-center gap-1.5\",children:[\" \",/*#__PURE__*/_jsx(Truck,{className:\"w-5 h-5 text-orange-500\"}),\" Pedidos Pendientes\"]}),pendingOrders.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-2 text-sm\",children:\"\\xA1No hay pedidos pendientes! Eres un campe\\xF3n.\"})// Reducido py, text-sm\n:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[\" \",/*#__PURE__*/_jsx(AnimatePresence,{children:pendingOrders.map(order=>{var _order$customers;// Usar los totales guardados en la orden, o recalcular si no existen (para compatibilidad)\nconst currentTotalPoints=order.total_points||calculateOrderTotals(order.order_items).totalPoints;const currentTotalPrice=order.total_price||calculateOrderTotals(order.order_items).totalPrice;return/*#__PURE__*/_jsxs(motion.div,{className:\"bg-orange-50 border border-orange-200 rounded-lg p-3 shadow-sm\"// Reducido padding, rounded, shadow\n,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{duration:0.3},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-1\",children:[\" \",/*#__PURE__*/_jsxs(\"p\",{className:\"text-base font-semibold\",children:[\" \",\"Cliente: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-extrabold text-orange-700\",children:((_order$customers=order.customers)===null||_order$customers===void 0?void 0:_order$customers.name)||'N/A'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-700\",children:[\" \",\"Fecha: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-extrabold text-orange-700\",children:new Date(order.delivery_date).toLocaleDateString()})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-600 mb-1\",children:[\" \",/*#__PURE__*/_jsx(\"p\",{children:\"Productos:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-disc list-inside ml-4\",children:[\" \",order.order_items.map(item=>{const product=products.find(p=>p.id===item.product_id);return/*#__PURE__*/_jsxs(\"li\",{children:[(product===null||product===void 0?void 0:product.name)||'Producto Desconocido',\" x \",item.quantity]},item.id);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-sm\",children:[\" \",/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700\",children:[\"Puntos: \",currentTotalPoints]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700\",children:[\"Precio: S/. \",currentTotalPrice.toFixed(2)]})]}),order.status==='pending'&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-2\",children:[\" \",/*#__PURE__*/_jsxs(motion.button,{onClick:()=>handleUpdateOrderStatus(order.id,'delivered'),className:\"flex-1 bg-green-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-green-600 transition-colors\"// Reducido py, rounded, text-sm, gap\n,whileHover:{scale:1.05},whileTap:{scale:0.95},children:[/*#__PURE__*/_jsx(CheckCircle,{className:\"w-4 h-4\"}),\" Entregado\"]}),/*#__PURE__*/_jsxs(motion.button,{onClick:()=>handleUpdateOrderStatus(order.id,'cancelled'),className:\"flex-1 bg-red-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-red-600 transition-colors\"// Reducido py, rounded, text-sm, gap\n,whileHover:{scale:1.05},whileTap:{scale:0.95},children:[/*#__PURE__*/_jsx(XCircle,{className:\"w-4 h-4\"}),\" Cancelado\"]})]})]},order.id);})})]}),pendingOrders.length>0&&/*#__PURE__*/_jsx(motion.div,{className:\"mt-3 pt-2 border-t border-gray-200/50 flex justify-between items-center text-sm\"// Reducido mt, pt, text-sm\n,initial:{opacity:0},animate:{opacity:1},transition:{delay:0.5},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-gray-800 flex items-center gap-1\",children:[\" \",/*#__PURE__*/_jsx(Star,{className:\"w-4 h-4 text-yellow-500\"}),\" Puntos Pendientes: \",totalPendingPoints.toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-gray-800 flex items-center gap-1\",children:[\" \",/*#__PURE__*/_jsx(DollarSign,{className:\"w-4 h-4 text-green-500\"}),\" Precio Pendientes: S/. \",totalPendingPrice.toFixed(2)]})]})})]}),/*#__PURE__*/_jsxs(motion.div,{className:\"bg-white/90 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-4 mb-4 shadow-md\"// Reducido padding, mb, shadow, rounded\n,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.5,delay:0.4},children:[/*#__PURE__*/_jsxs(\"h2\",{className:\"text-xl font-bold text-gray-800 mb-2 flex items-center gap-1.5\",children:[\" \",/*#__PURE__*/_jsx(History,{className:\"w-5 h-5 text-blue-500\"}),\" Entregados (\\xDAltimos 60 d\\xEDas)\"]}),deliveredOrdersLast60Days.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500 text-center py-2 text-sm\",children:\"Nadie ha comprado nada en los \\xFAltimos 60 d\\xEDas. \\xA1A vender!\"})// Reducido py, text-sm\n:/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-2\",children:[\" \",/*#__PURE__*/_jsx(AnimatePresence,{children:deliveredOrdersLast60Days.map(order=>{var _order$customers2,_order$customers3;// Usar los totales guardados en la orden, o recalcular si no existen\nconst currentTotalPoints=order.total_points||calculateOrderTotals(order.order_items).totalPoints;const currentTotalPrice=order.total_price||calculateOrderTotals(order.order_items).totalPrice;return/*#__PURE__*/_jsxs(motion.div,{className:\"bg-blue-50 border border-blue-200 rounded-lg p-3 shadow-sm\"// Reducido padding, rounded, shadow\n,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:0.3},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center mb-1\",children:[\" \",/*#__PURE__*/_jsxs(\"p\",{className:\"text-base font-semibold\",children:[\" \",\"Cliente: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-extrabold text-blue-700\",children:((_order$customers2=order.customers)===null||_order$customers2===void 0?void 0:_order$customers2.name)||'N/A'})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-700\",children:[\" \",\"Fecha: \",/*#__PURE__*/_jsx(\"span\",{className:\"font-extrabold text-blue-700\",children:new Date(order.completed_at).toLocaleDateString()})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-600 mb-1\",children:[\" \",/*#__PURE__*/_jsx(\"p\",{children:\"Productos Comprados:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"list-disc list-inside ml-4\",children:[\" \",order.order_items.map(item=>{const product=products.find(p=>p.id===item.product_id);return/*#__PURE__*/_jsxs(\"li\",{children:[(product===null||product===void 0?void 0:product.name)||'Producto Desconocido',\" x \",item.quantity]},item.id);})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-center text-sm\",children:[\" \",/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700\",children:[\"Puntos: \",currentTotalPoints]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-gray-700\",children:[\"Precio: S/. \",currentTotalPrice.toFixed(2)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-2 mt-2\",children:[/*#__PURE__*/_jsx(\"input\",{id:`paid-${order.id}`,type:\"checkbox\",checked:order.is_paid,onChange:()=>handleTogglePaidStatus(order.id,order.is_paid),className:\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"}),/*#__PURE__*/_jsx(\"label\",{htmlFor:`paid-${order.id}`,className:\"text-gray-700 font-medium text-sm\",children:order.is_paid?'Pagado':'Pendiente de Pago'})]}),((_order$customers3=order.customers)===null||_order$customers3===void 0?void 0:_order$customers3.phone_number)&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex gap-2 mt-3\",children:[/*#__PURE__*/_jsxs(motion.a,{href:`tel:${order.customers.phone_number}`,className:\"flex-1 bg-blue-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-blue-600 transition-colors\"// Reducido py, rounded, text-sm, gap\n,whileHover:{scale:1.05},whileTap:{scale:0.95},children:[/*#__PURE__*/_jsx(Phone,{className:\"w-4 h-4\"}),\" Llamar\"]}),/*#__PURE__*/_jsxs(motion.a,{href:getWhatsAppLink(order.customers.phone_number,`¡Hola ${order.customers.name}! ¿Cómo te va con tus productos Fuxion? ¡Tenemos novedades para ti!`),target:\"_blank\",rel:\"noopener noreferrer\",className:\"flex-1 bg-green-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-green-600 transition-colors\"// Reducido py, rounded, text-sm, gap\n,whileHover:{scale:1.05},whileTap:{scale:0.95},children:[/*#__PURE__*/_jsx(MessageSquare,{className:\"w-4 h-4\"}),\" WhatsApp\"]})]})]},order.id);})})]}),deliveredOrdersLast60Days.length>0&&/*#__PURE__*/_jsx(motion.div,{className:\"mt-3 pt-2 border-t border-gray-200/50 flex justify-between items-center text-sm\"// Reducido mt, pt, text-sm\n,initial:{opacity:0},animate:{opacity:1},transition:{delay:0.5},children:/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-gray-800 flex items-center gap-1\",children:[\" \",/*#__PURE__*/_jsx(Star,{className:\"w-4 h-4 text-yellow-500\"}),\" Puntos Entregados (60 d\\xEDas): \",totalDelivered60DaysPoints.toFixed(2)]}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-bold text-gray-800 flex items-center gap-1\",children:[\" \",/*#__PURE__*/_jsx(DollarSign,{className:\"w-4 h-4 text-green-500\"}),\" Precio Entregados (60 d\\xEDas): S/. \",totalDelivered60DaysPrice.toFixed(2)]})]})})]})]})]});};export default Home;","map":{"version":3,"names":["React","useState","useEffect","motion","AnimatePresence","Plus","CheckCircle","XCircle","Truck","History","Phone","MessageSquare","DollarSign","Star","supabase","LoadingSpinner","parseISO","isBefore","subDays","isValid","jsx","_jsx","jsxs","_jsxs","Home","loading","setLoading","orders","setOrders","products","setProducts","customers","setCustomers","showNewOrderModal","setShowNewOrderModal","selectedCustomer","setSelectedCustomer","selectedProducts","setSelectedProducts","productId","quantity","deliveryDate","setDeliveryDate","isPaidNewOrder","setIsPaidNewOrder","fetchData","data","user","auth","getUser","productsData","error","productsError","from","select","eq","id","console","message","ordersData","ordersError","order","ascending","customersData","customersError","calculateOrderTotals","orderItems","totalPoints","totalPrice","forEach","item","product","find","p","product_id","points_per_unit","price_per_unit","handleUpdateOrderStatus","orderId","status","completedAt","Date","toISOString","updateData","completed_at","is_paid","orderUpdateError","update","orderToUpdate","o","order_items","currentProductData","fetchProductError","single","newQuantity","productUpdateError","handleTogglePaidStatus","currentPaidStatus","handleAddProductToOrder","handleProductChange","index","field","value","newSelectedProducts","handleRemoveProductFromOrder","filter","_","i","handleCreateOrder","e","preventDefault","alert","userId","newOrder","orderError","insert","customer_id","delivery_date","total_points","total_price","user_id","orderItemsToInsert","map","order_id","points_at_sale","price_at_sale","orderItemsError","delete","getWhatsAppLink","phoneNumber","formattedPhone","replace","encodeURIComponent","pendingOrders","deliveredOrdersLast60Days","completedDate","sixtyDaysAgo","totalPendingPoints","reduce","sum","totalPendingPrice","totalDelivered60DaysPoints","totalDelivered60DaysPrice","className","children","h1","initial","opacity","y","animate","transition","duration","div","delay","button","onClick","whileHover","scale","whileTap","exit","type","stiffness","damping","onSubmit","htmlFor","onChange","target","required","customer","name","parseInt","min","checked","length","_order$customers","currentTotalPoints","currentTotalPrice","x","toLocaleDateString","toFixed","_order$customers2","_order$customers3","phone_number","a","href","rel"],"sources":["C:/Users/donny/Downloads/project (1)/src/pages/Home.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Plus, CheckCircle, XCircle, Truck, History, Phone, MessageSquare, DollarSign, Star } from 'lucide-react';\nimport { supabase } from '../supabaseClient';\nimport LoadingSpinner from '../components/LoadingSpinner';\nimport { parseISO, isBefore, subDays, isValid } from 'date-fns';\n\nconst Home = () => {\n  const [loading, setLoading] = useState(true);\n  const [orders, setOrders] = useState([]);\n  const [products, setProducts] = useState([]);\n  const [customers, setCustomers] = useState([]);\n  const [showNewOrderModal, setShowNewOrderModal] = useState(false);\n\n  // Formulario de nuevo pedido\n  const [selectedCustomer, setSelectedCustomer] = useState('');\n  const [selectedProducts, setSelectedProducts] = useState([{ productId: '', quantity: 1 }]);\n  const [deliveryDate, setDeliveryDate] = useState('');\n  const [isPaidNewOrder, setIsPaidNewOrder] = useState(true); // Nuevo estado para el checkbox de pago\n\n  useEffect(() => {\n    fetchData();\n  }, []);\n\n  const fetchData = async () => {\n    setLoading(true);\n    const { data: { user } } = await supabase.auth.getUser(); // Obtener el usuario actual\n    if (!user) {\n      setLoading(false);\n      // Si no hay usuario, no se pueden cargar datos específicos del usuario\n      // Puedes mostrar un mensaje o redirigir si es necesario\n      return; \n    }\n\n    const { data: productsData, error: productsError } = await supabase\n      .from('products')\n      .select('*')\n      .eq('user_id', user.id); // Filtrar por user_id\n    if (productsError) console.error('Error fetching products:', productsError.message);\n    setProducts(productsData || []);\n\n    const { data: ordersData, error: ordersError } = await supabase\n      .from('orders')\n      .select('*, order_items(*), customers(id, name, phone_number)')\n      .eq('user_id', user.id) // Filtrar por user_id\n      .order('delivery_date', { ascending: true });\n\n    if (ordersError) console.error('Error fetching orders:', ordersError.message);\n    setOrders(ordersData || []);\n\n    const { data: customersData, error: customersError } = await supabase\n      .from('customers')\n      .select('*')\n      .eq('user_id', user.id); // Filtrar por user_id\n\n    if (customersError) console.error('Error fetching customers:', customersError.message);\n    setCustomers(customersData || []);\n    setLoading(false);\n  };\n\n  const calculateOrderTotals = (orderItems) => {\n    let totalPoints = 0;\n    let totalPrice = 0;\n    orderItems.forEach(item => {\n      const product = products.find(p => p.id === (item.productId || item.product_id));\n      if (product) {\n        totalPoints += product.points_per_unit * item.quantity;\n        totalPrice += product.price_per_unit * item.quantity;\n      }\n    });\n    return { totalPoints, totalPrice };\n  };\n\n  const handleUpdateOrderStatus = async (orderId, status) => {\n    setLoading(true);\n    const completedAt = status === 'delivered' ? new Date().toISOString() : null;\n    const { data: { user } } = await supabase.auth.getUser();\n\n    // Si se marca como entregado, por defecto se marca como pagado\n    const updateData = { status: status, completed_at: completedAt };\n    if (status === 'delivered') {\n      updateData.is_paid = true; // Por defecto, pagado al entregar\n    }\n\n    const { error: orderUpdateError } = await supabase\n      .from('orders')\n      .update(updateData)\n      .eq('id', orderId)\n      .eq('user_id', user.id); // Asegurar que solo se actualiza la propia orden\n\n    if (orderUpdateError) {\n      console.error('Error updating order status:', orderUpdateError.message);\n      setLoading(false);\n      return;\n    }\n\n    if (status === 'delivered') {\n      const orderToUpdate = orders.find(o => o.id === orderId);\n      if (orderToUpdate && orderToUpdate.order_items) {\n        for (const item of orderToUpdate.order_items) {\n          const { data: currentProductData, error: fetchProductError } = await supabase\n            .from('products')\n            .select('quantity')\n            .eq('id', item.product_id)\n            .eq('user_id', user.id) // Asegurar que solo se actualiza el propio producto\n            .single();\n\n          if (fetchProductError) {\n            console.error('Error fetching current product quantity:', fetchProductError.message);\n            continue;\n          }\n\n          if (currentProductData) {\n            const newQuantity = currentProductData.quantity - item.quantity;\n            const { error: productUpdateError } = await supabase\n              .from('products')\n              .update({ quantity: newQuantity })\n              .eq('id', item.product_id)\n              .eq('user_id', user.id); // Asegurar que solo se actualiza el propio producto\n            if (productUpdateError) console.error('Error updating product quantity:', productUpdateError.message);\n          }\n        }\n      }\n    }\n    await fetchData();\n    setLoading(false);\n  };\n\n  const handleTogglePaidStatus = async (orderId, currentPaidStatus) => {\n    setLoading(true);\n    const { data: { user } } = await supabase.auth.getUser();\n\n    const { error } = await supabase\n      .from('orders')\n      .update({ is_paid: !currentPaidStatus })\n      .eq('id', orderId)\n      .eq('user_id', user.id);\n\n    if (error) {\n      console.error('Error updating paid status:', error.message);\n    }\n    await fetchData();\n    setLoading(false);\n  };\n\n  const handleAddProductToOrder = () => {\n    setSelectedProducts([...selectedProducts, { productId: '', quantity: 1 }]);\n  };\n\n  const handleProductChange = (index, field, value) => {\n    const newSelectedProducts = [...selectedProducts];\n    newSelectedProducts[index][field] = value;\n    setSelectedProducts(newSelectedProducts);\n  };\n\n  const handleRemoveProductFromOrder = (index) => {\n    const newSelectedProducts = selectedProducts.filter((_, i) => i !== index);\n    setSelectedProducts(newSelectedProducts);\n  };\n\n  const handleCreateOrder = async (e) => {\n    e.preventDefault();\n    setLoading(true);\n\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) {\n      alert('Debes iniciar sesión para crear un pedido.');\n      setLoading(false);\n      return;\n    }\n    const userId = user.id;\n\n    const { totalPoints, totalPrice } = calculateOrderTotals(selectedProducts);\n\n    const { data: newOrder, error: orderError } = await supabase\n      .from('orders')\n      .insert({\n        customer_id: selectedCustomer,\n        delivery_date: deliveryDate,\n        total_points: totalPoints,\n        total_price: totalPrice,\n        status: 'pending',\n        is_paid: isPaidNewOrder, // Usar el estado del checkbox\n        user_id: userId // Asignar el user_id\n      })\n      .select()\n      .single();\n\n    if (orderError) {\n      console.error('Error creating order:', orderError.message);\n      setLoading(false);\n      return;\n    }\n\n    const orderItemsToInsert = selectedProducts.map(item => {\n      const product = products.find(p => p.id === item.productId);\n      return {\n        order_id: newOrder.id,\n        product_id: item.productId,\n        quantity: item.quantity,\n        points_at_sale: product ? product.points_per_unit : 0,\n        price_at_sale: product ? product.price_per_unit : 0\n      };\n    });\n\n    const { error: orderItemsError } = await supabase\n      .from('order_items')\n      .insert(orderItemsToInsert);\n\n    if (orderItemsError) {\n      console.error('Error creating order items:', orderItemsError.message);\n      await supabase.from('orders').delete().eq('id', newOrder.id);\n    } else {\n      setShowNewOrderModal(false);\n      setSelectedCustomer('');\n      setSelectedProducts([{ productId: '', quantity: 1 }]);\n      setDeliveryDate('');\n      setIsPaidNewOrder(true); // Resetear a pagado por defecto\n      await fetchData();\n    }\n    setLoading(false);\n  };\n\n  const getWhatsAppLink = (phoneNumber, message) => {\n    const formattedPhone = phoneNumber.replace(/\\D/g, '');\n    return `https://wa.me/${formattedPhone}?text=${encodeURIComponent(message)}`;\n  };\n\n  const pendingOrders = orders.filter(order => order.status === 'pending');\n  const deliveredOrdersLast60Days = orders.filter(order => {\n    if (order.status !== 'delivered' || !order.completed_at) {\n      return false;\n    }\n    const completedDate = parseISO(order.completed_at);\n    const sixtyDaysAgo = subDays(new Date(), 60);\n    return isValid(completedDate) && isBefore(sixtyDaysAgo, completedDate);\n  });\n\n  // Calcular totales para pedidos pendientes\n  const totalPendingPoints = pendingOrders.reduce((sum, order) => sum + (order.total_points || 0), 0);\n  const totalPendingPrice = pendingOrders.reduce((sum, order) => sum + (order.total_price || 0), 0);\n\n  // Calcular totales para pedidos entregados en los últimos 60 días\n  const totalDelivered60DaysPoints = deliveredOrdersLast60Days.reduce((sum, order) => sum + (order.total_points || 0), 0);\n  const totalDelivered60DaysPrice = deliveredOrdersLast60Days.reduce((sum, order) => sum + (order.total_price || 0), 0);\n\n\n  if (loading) {\n    return <LoadingSpinner />;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 pb-4\"> {/* Reducido pb */}\n      <div className=\"container mx-auto px-2 py-4 max-w-4xl\"> {/* Reducido px y py */}\n        <motion.h1\n          className=\"text-3xl font-extrabold text-gray-900 mb-4 text-center bg-clip-text text-transparent bg-gradient-to-r from-blue-600 to-purple-600\" // Reducido text-4xl a text-3xl, mb-6 a mb-4\n          initial={{ opacity: 0, y: -50 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.6 }}\n        >\n          FuxionFlow\n        </motion.h1>\n\n        {/* Sección de Nuevo Pedido */}\n        <motion.div\n          className=\"bg-white/90 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-4 mb-4 shadow-md\" // Reducido padding, mb, shadow, rounded\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.2 }}\n        >\n          <h2 className=\"text-xl font-bold text-gray-800 mb-2 flex items-center gap-1.5\"> {/* Reducido text-2xl a text-xl, mb-3 a mb-2 */}\n            <Plus className=\"w-5 h-5 text-blue-500\" /> Nuevo Pedido\n          </h2>\n          <motion.button\n            onClick={() => setShowNewOrderModal(true)}\n            className=\"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-2 rounded-lg font-semibold shadow-sm hover:shadow-md hover:scale-105 transition-all duration-300 flex items-center justify-center gap-1.5\" // Reducido py, rounded, shadow\n            whileHover={{ scale: 1.02 }}\n            whileTap={{ scale: 0.98 }}\n          >\n            <Plus className=\"w-4 h-4\" /> {/* Reducido w, h */}\n            Crear Nuevo Pedido\n          </motion.button>\n        </motion.div>\n\n        {/* Modal de Nuevo Pedido */}\n        <AnimatePresence>\n          {showNewOrderModal && (\n            <motion.div\n              className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-2 z-50\" // Reducido padding\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              exit={{ opacity: 0 }}\n            >\n              <motion.div\n                className=\"bg-white rounded-2xl p-5 shadow-xl max-w-md w-full max-h-[95vh] overflow-y-auto\" // Reducido padding, rounded, max-h\n                initial={{ scale: 0.9, y: 50 }}\n                animate={{ scale: 1, y: 0 }}\n                exit={{ scale: 0.9, y: 50 }}\n                transition={{ type: 'spring', stiffness: 100, damping: 15 }}\n              >\n                <h3 className=\"text-xl font-bold text-gray-800 mb-4\">Detalles del Nuevo Pedido</h3> {/* Reducido text-2xl a text-xl, mb-5 a mb-4 */}\n                <form onSubmit={handleCreateOrder} className=\"space-y-3\"> {/* Reducido space-y-4 a space-y-3 */}\n                  <div>\n                    <label htmlFor=\"customer\" className=\"block text-gray-700 font-medium mb-1\">Cliente:</label> {/* Reducido mb-1.5 a mb-1 */}\n                    <select\n                      id=\"customer\"\n                      value={selectedCustomer}\n                      onChange={(e) => setSelectedCustomer(e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30\" // Reducido py, rounded\n                      required\n                    >\n                      <option value=\"\">Selecciona un cliente</option>\n                      {customers.map(customer => (\n                        <option key={customer.id} value={customer.id}>{customer.name}</option>\n                      ))}\n                    </select>\n                  </div>\n\n                  <div className=\"space-y-2\"> {/* Reducido space-y-3 a space-y-2 */}\n                    <label className=\"block text-gray-700 font-medium mb-1\">Productos:</label> {/* Reducido mb-1.5 a mb-1 */}\n                    {selectedProducts.map((item, index) => (\n                      <div key={index} className=\"flex items-end gap-2 bg-gray-50 p-2 rounded-lg border border-gray-200\"> {/* Reducido padding, rounded */}\n                        <div className=\"flex-1\">\n                          <label htmlFor={`product-${index}`} className=\"block text-gray-600 text-xs mb-0.5\">Producto:</label> {/* Reducido text-sm a text-xs */}\n                          <select\n                            id={`product-${index}`}\n                            value={item.productId}\n                            onChange={(e) => handleProductChange(index, 'productId', e.target.value)}\n                            className=\"w-full px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500/30\" // Reducido py, rounded\n                            required\n                          >\n                            <option value=\"\">Selecciona un producto</option>\n                            {products.map(product => (\n                              <option key={product.id} value={product.id}>{product.name}</option>\n                            ))}\n                          </select>\n                        </div>\n                        <div>\n                          <label htmlFor={`quantity-${index}`} className=\"block text-gray-600 text-xs mb-0.5\">Cant:</label> {/* Reducido text-sm a text-xs */}\n                          <input\n                            id={`quantity-${index}`}\n                            type=\"number\"\n                            value={item.quantity}\n                            onChange={(e) => handleProductChange(index, 'quantity', parseInt(e.target.value) || 1)}\n                            min=\"1\"\n                            className=\"w-14 px-2 py-1.5 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500/30\" // Reducido w, py, rounded\n                            required\n                          />\n                        </div>\n                        <motion.button\n                          type=\"button\"\n                          onClick={() => handleRemoveProductFromOrder(index)}\n                          className=\"p-1 bg-red-100 text-red-600 rounded-md hover:bg-red-200 transition-colors\" // Reducido padding, rounded\n                          whileHover={{ scale: 1.1 }}\n                          whileTap={{ scale: 0.9 }}\n                        >\n                          <XCircle className=\"w-3 h-3\" /> {/* Reducido w, h */}\n                        </motion.button>\n                      </div>\n                    ))}\n                    <motion.button\n                      type=\"button\"\n                      onClick={handleAddProductToOrder}\n                      className=\"w-full bg-blue-100 text-blue-600 py-1.5 rounded-lg font-semibold text-sm hover:bg-blue-200 transition-colors flex items-center justify-center gap-1.5\" // Reducido py, rounded, text-sm\n                      whileHover={{ scale: 1.02 }}\n                      whileTap={{ scale: 0.98 }}\n                    >\n                      <Plus className=\"w-3 h-3\" /> {/* Reducido w, h */}\n                      Agregar Otro Producto\n                    </motion.button>\n                  </div>\n\n                  <div>\n                    <label htmlFor=\"deliveryDate\" className=\"block text-gray-700 font-medium mb-1\">Fecha de Entrega:</label> {/* Reducido mb-1.5 a mb-1 */}\n                    <input\n                      id=\"deliveryDate\"\n                      type=\"date\"\n                      value={deliveryDate}\n                      onChange={(e) => setDeliveryDate(e.target.value)}\n                      className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30\" // Reducido py, rounded\n                      required\n                    />\n                  </div>\n\n                  <div className=\"flex items-center gap-2\">\n                    <input\n                      id=\"isPaidNewOrder\"\n                      type=\"checkbox\"\n                      checked={isPaidNewOrder}\n                      onChange={(e) => setIsPaidNewOrder(e.target.checked)}\n                      className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                    />\n                    <label htmlFor=\"isPaidNewOrder\" className=\"text-gray-700 font-medium text-sm\">Pedido Pagado</label>\n                  </div>\n\n                  <div className=\"flex justify-end gap-2 mt-4\"> {/* Reducido gap, mt */}\n                    <motion.button\n                      type=\"button\"\n                      onClick={() => setShowNewOrderModal(false)}\n                      className=\"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg font-semibold text-sm hover:bg-gray-300 transition-colors\" // Reducido px, py, rounded, text-sm\n                      whileHover={{ scale: 1.05 }}\n                      whileTap={{ scale: 0.95 }}\n                    >\n                      Cancelar\n                    </motion.button>\n                    <motion.button\n                      type=\"submit\"\n                      className=\"px-4 py-2 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold text-sm shadow-sm hover:shadow-md hover:scale-105 transition-all duration-300\" // Reducido px, py, rounded, text-sm, shadow\n                      whileHover={{ scale: 1.05 }}\n                      whileTap={{ scale: 0.95 }}\n                    >\n                      Guardar Pedido\n                    </motion.button>\n                  </div>\n                </form>\n              </motion.div>\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {/* Sección de Pedidos Pendientes */}\n        <motion.div\n          className=\"bg-white/90 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-4 mb-4 shadow-md\" // Reducido padding, mb, shadow, rounded\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.3 }}\n        >\n          <h2 className=\"text-xl font-bold text-gray-800 mb-2 flex items-center gap-1.5\"> {/* Reducido text-2xl a text-xl, mb-3 a mb-2 */}\n            <Truck className=\"w-5 h-5 text-orange-500\" /> Pedidos Pendientes\n          </h2>\n          {pendingOrders.length === 0 ? (\n            <p className=\"text-gray-500 text-center py-2 text-sm\">¡No hay pedidos pendientes! Eres un campeón.</p> // Reducido py, text-sm\n          ) : (\n            <div className=\"space-y-2\"> {/* Reducido space-y-3 a space-y-2 */}\n              <AnimatePresence>\n                {pendingOrders.map((order) => {\n                  // Usar los totales guardados en la orden, o recalcular si no existen (para compatibilidad)\n                  const currentTotalPoints = order.total_points || calculateOrderTotals(order.order_items).totalPoints;\n                  const currentTotalPrice = order.total_price || calculateOrderTotals(order.order_items).totalPrice;\n                  return (\n                    <motion.div\n                      key={order.id}\n                      className=\"bg-orange-50 border border-orange-200 rounded-lg p-3 shadow-sm\" // Reducido padding, rounded, shadow\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      exit={{ opacity: 0, x: -50 }}\n                      transition={{ duration: 0.3 }}\n                    >\n                      <div className=\"flex justify-between items-center mb-1\"> {/* Reducido mb */}\n                        <p className=\"text-base font-semibold\"> {/* Reducido text-lg a text-base */}\n                          Cliente: <span className=\"font-extrabold text-orange-700\">{order.customers?.name || 'N/A'}</span>\n                        </p>\n                        <p className=\"text-sm text-gray-700\"> {/* Reducido text-md a text-sm */}\n                          Fecha: <span className=\"font-extrabold text-orange-700\">{new Date(order.delivery_date).toLocaleDateString()}</span>\n                        </p>\n                      </div>\n                      <div className=\"text-xs text-gray-600 mb-1\"> {/* Reducido text-sm a text-xs, mb-2 a mb-1 */}\n                        <p>Productos:</p>\n                        <ul className=\"list-disc list-inside ml-4\"> {/* Reducido ml-2 a ml-4 */}\n                          {order.order_items.map(item => {\n                            const product = products.find(p => p.id === item.product_id);\n                            return (\n                              <li key={item.id}>\n                                {product?.name || 'Producto Desconocido'} x {item.quantity}\n                              </li>\n                            );\n                          })}\n                        </ul>\n                      </div>\n                      <div className=\"flex justify-between items-center text-sm\"> {/* Añadido text-sm */}\n                        <p className=\"text-gray-700\">Puntos: {currentTotalPoints}</p>\n                        <p className=\"text-gray-700\">Precio: S/. {currentTotalPrice.toFixed(2)}</p>\n                      </div>\n                      {/* Mostrar botones solo si el estado es 'pending' */}\n                      {order.status === 'pending' && (\n                        <div className=\"flex gap-2 mt-2\"> {/* Reducido mt */}\n                          <motion.button\n                            onClick={() => handleUpdateOrderStatus(order.id, 'delivered')}\n                            className=\"flex-1 bg-green-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-green-600 transition-colors\" // Reducido py, rounded, text-sm, gap\n                            whileHover={{ scale: 1.05 }}\n                            whileTap={{ scale: 0.95 }}\n                          >\n                            <CheckCircle className=\"w-4 h-4\" /> Entregado\n                          </motion.button>\n                          <motion.button\n                            onClick={() => handleUpdateOrderStatus(order.id, 'cancelled')}\n                            className=\"flex-1 bg-red-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-red-600 transition-colors\" // Reducido py, rounded, text-sm, gap\n                            whileHover={{ scale: 1.05 }}\n                            whileTap={{ scale: 0.95 }}\n                          >\n                            <XCircle className=\"w-4 h-4\" /> Cancelado\n                          </motion.button>\n                        </div>\n                      )}\n                    </motion.div>\n                  );\n                })}\n              </AnimatePresence>\n            </div>\n          )}\n          {pendingOrders.length > 0 && (\n            <motion.div\n              className=\"mt-3 pt-2 border-t border-gray-200/50 flex justify-between items-center text-sm\" // Reducido mt, pt, text-sm\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ delay: 0.5 }}\n            >\n              <div>\n                <p className=\"font-bold text-gray-800 flex items-center gap-1\"> {/* Reducido text-lg a normal, gap */}\n                  <Star className=\"w-4 h-4 text-yellow-500\" /> Puntos Pendientes: {totalPendingPoints.toFixed(2)}\n                </p>\n                <p className=\"font-bold text-gray-800 flex items-center gap-1\"> {/* Reducido text-lg a normal, gap */}\n                  <DollarSign className=\"w-4 h-4 text-green-500\" /> Precio Pendientes: S/. {totalPendingPrice.toFixed(2)}\n                </p>\n              </div>\n            </motion.div>\n          )}\n        </motion.div>\n\n        {/* Sección de Pedidos Entregados (Últimos 60 días) */}\n        <motion.div\n          className=\"bg-white/90 backdrop-blur-xl border border-gray-200/50 rounded-2xl p-4 mb-4 shadow-md\" // Reducido padding, mb, shadow, rounded\n          initial={{ opacity: 0, y: 20 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.5, delay: 0.4 }}\n        >\n          <h2 className=\"text-xl font-bold text-gray-800 mb-2 flex items-center gap-1.5\"> {/* Reducido text-2xl a text-xl, mb-3 a mb-2 */}\n            <History className=\"w-5 h-5 text-blue-500\" /> Entregados (Últimos 60 días)\n          </h2>\n          {deliveredOrdersLast60Days.length === 0 ? (\n            <p className=\"text-gray-500 text-center py-2 text-sm\">Nadie ha comprado nada en los últimos 60 días. ¡A vender!</p> // Reducido py, text-sm\n          ) : (\n            <div className=\"space-y-2\"> {/* Reducido space-y-3 a space-y-2 */}\n              <AnimatePresence>\n                {deliveredOrdersLast60Days.map((order) => {\n                  // Usar los totales guardados en la orden, o recalcular si no existen\n                  const currentTotalPoints = order.total_points || calculateOrderTotals(order.order_items).totalPoints;\n                  const currentTotalPrice = order.total_price || calculateOrderTotals(order.order_items).totalPrice;\n                  return (\n                    <motion.div\n                      key={order.id}\n                      className=\"bg-blue-50 border border-blue-200 rounded-lg p-3 shadow-sm\" // Reducido padding, rounded, shadow\n                      initial={{ opacity: 0, y: 20 }}\n                      animate={{ opacity: 1, y: 0 }}\n                      transition={{ duration: 0.3 }}\n                    >\n                      <div className=\"flex justify-between items-center mb-1\"> {/* Reducido mb */}\n                        <p className=\"text-base font-semibold\"> {/* Reducido text-lg a text-base */}\n                          Cliente: <span className=\"font-extrabold text-blue-700\">{order.customers?.name || 'N/A'}</span>\n                        </p>\n                        <p className=\"text-sm text-gray-700\"> {/* Reducido text-md a text-sm */}\n                          Fecha: <span className=\"font-extrabold text-blue-700\">{new Date(order.completed_at).toLocaleDateString()}</span>\n                        </p>\n                      </div>\n                      <div className=\"text-xs text-gray-600 mb-1\"> {/* Reducido text-sm a text-xs, mb-2 a mb-1 */}\n                        <p>Productos Comprados:</p>\n                        <ul className=\"list-disc list-inside ml-4\"> {/* Reducido ml-2 a ml-4 */}\n                          {order.order_items.map(item => {\n                            const product = products.find(p => p.id === item.product_id);\n                            return (\n                              <li key={item.id}>\n                                {product?.name || 'Producto Desconocido'} x {item.quantity}\n                              </li>\n                            );\n                          })}\n                        </ul>\n                      </div>\n                      <div className=\"flex justify-between items-center text-sm\"> {/* Añadido text-sm */}\n                        <p className=\"text-gray-700\">Puntos: {currentTotalPoints}</p>\n                        <p className=\"text-gray-700\">Precio: S/. {currentTotalPrice.toFixed(2)}</p>\n                      </div>\n                      <div className=\"flex items-center gap-2 mt-2\">\n                        <input\n                          id={`paid-${order.id}`}\n                          type=\"checkbox\"\n                          checked={order.is_paid}\n                          onChange={() => handleTogglePaidStatus(order.id, order.is_paid)}\n                          className=\"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded\"\n                        />\n                        <label htmlFor={`paid-${order.id}`} className=\"text-gray-700 font-medium text-sm\">\n                          {order.is_paid ? 'Pagado' : 'Pendiente de Pago'}\n                        </label>\n                      </div>\n                      {order.customers?.phone_number && (\n                        <div className=\"flex gap-2 mt-3\">\n                          <motion.a\n                            href={`tel:${order.customers.phone_number}`}\n                            className=\"flex-1 bg-blue-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-blue-600 transition-colors\" // Reducido py, rounded, text-sm, gap\n                            whileHover={{ scale: 1.05 }}\n                            whileTap={{ scale: 0.95 }}\n                          >\n                            <Phone className=\"w-4 h-4\" /> Llamar\n                          </motion.a>\n                          <motion.a\n                            href={getWhatsAppLink(order.customers.phone_number, `¡Hola ${order.customers.name}! ¿Cómo te va con tus productos Fuxion? ¡Tenemos novedades para ti!`)}\n                            target=\"_blank\"\n                            rel=\"noopener noreferrer\"\n                            className=\"flex-1 bg-green-500 text-white py-1.5 rounded-lg font-semibold text-sm flex items-center justify-center gap-1 hover:bg-green-600 transition-colors\" // Reducido py, rounded, text-sm, gap\n                            whileHover={{ scale: 1.05 }}\n                            whileTap={{ scale: 0.95 }}\n                          >\n                            <MessageSquare className=\"w-4 h-4\" /> WhatsApp\n                          </motion.a>\n                        </div>\n                      )}\n                    </motion.div>\n                  );\n                })}\n              </AnimatePresence>\n            </div>\n          )}\n          {deliveredOrdersLast60Days.length > 0 && (\n            <motion.div\n              className=\"mt-3 pt-2 border-t border-gray-200/50 flex justify-between items-center text-sm\" // Reducido mt, pt, text-sm\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ delay: 0.5 }}\n            >\n              <div>\n                <p className=\"font-bold text-gray-800 flex items-center gap-1\"> {/* Reducido text-lg a normal, gap */}\n                  <Star className=\"w-4 h-4 text-yellow-500\" /> Puntos Entregados (60 días): {totalDelivered60DaysPoints.toFixed(2)}\n                </p>\n                <p className=\"font-bold text-gray-800 flex items-center gap-1\"> {/* Reducido text-lg a normal, gap */}\n                  <DollarSign className=\"w-4 h-4 text-green-500\" /> Precio Entregados (60 días): S/. {totalDelivered60DaysPrice.toFixed(2)}\n                </p>\n              </div>\n            </motion.div>\n          )}\n        </motion.div>\n      </div>\n    </div>\n  );\n};\n\nexport default Home;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}